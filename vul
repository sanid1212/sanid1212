import os
import re

# Define the directory to scan
root_dir = "/path/to/your/directory"

# Define a comprehensive pattern for sensitive information
sensitive_pattern = r'\b(?:password[_\s]*[=:]|api[_\s]*[_\.]?key[_\s]*[=:]|secret[_\s]*[=:])(?:"(.*?)"|\'(.*?)\')\b'

def scan_directory(root_dir):
    for dirpath, dirnames, filenames in os.walk(root_dir):
        for filename in filenames:
            file_path = os.path.join(dirpath, filename)

            # Check if the file has a .txt extension and skip it if not
            if not file_path.endswith('.txt'):
                continue
            
            scan_file(file_path)

def scan_file(file_path):
    try:
        with open(file_path, 'r', encoding='utf-8') as file:
            lines = file.readlines()

            for line_number, line in enumerate(lines, start=1):
                sensitive_matches = re.findall(sensitive_pattern, line)

                if sensitive_matches:
                    print(f'Sensitive information found in {file_path}, line {line_number}')
                    for match in sensitive_matches:
                        print(f'Sensitive pattern detected: {match[0] or match[1]}')
                    print(f'Full line: {line.strip()}')

    except Exception as e:
        print(f"Error processing {file_path}: {str(e)}")

if __name__ == "__main__":
    scan_directory(root_dir)
