import os
import re

# Get the current directory
root_dir = os.getcwd()

# Define a comprehensive pattern for sensitive information
sensitive_pattern = r'\b(?i)(?:password[_\s]*[=:]|api[_\s]*[_\.]?key[_\s]*[=:]|... Your sensitive pattern ...)\b'

def scan_directory(root_dir):
    for filename in os.listdir(root_dir):
        file_path = os.path.join(root_dir, filename)

        # Check if the file is a .txt file and not a directory
        if filename.endswith('.txt') and os.path.isfile(file_path):
            scan_file(file_path)

def scan_file(file_path):
    try:
        with open(file_path, 'rb') as file:
            content = file.read()
        
        try:
            content = content.decode('utf-8')
        except UnicodeDecodeError:
            content = content.decode('ISO-8859-1')
            
        sensitive_matches = re.findall(sensitive_pattern, content)

        if sensitive_matches:
            print(f'Sensitive information found in {file_path}')
            for match in sensitive_matches:
                print(f'Sensitive pattern detected: {match}')

            # Implement your action here (e.g., log the findings or take other actions)
    except Exception as e:
        print(f"Error processing {file_path}: {str(e)}")

if __name__ == "__main__":
    scan_directory(root_dir)
